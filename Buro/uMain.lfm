object Main: TMain
  Left = 1190
  Height = 380
  Top = 166
  Width = 730
  Caption = 'Регистрация посетителя'
  ClientHeight = 380
  ClientWidth = 730
  Color = clBtnFace
  Constraints.MinHeight = 380
  Constraints.MinWidth = 730
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'Tahoma'
  OnClose = FormClose
  OnShow = FormShow
  LCLVersion = '1.6.0.4'
  object pnlTop: TPanel
    Left = 0
    Height = 41
    Top = 0
    Width = 730
    Align = alTop
    ClientHeight = 41
    ClientWidth = 730
    TabOrder = 0
    object btnNew: TButton
      Left = 8
      Height = 25
      Top = 9
      Width = 75
      Caption = 'Новый'
      OnClick = btnNewClick
      TabOrder = 0
    end
    object btnPrint: TButton
      Left = 170
      Height = 25
      Top = 10
      Width = 75
      Caption = 'Талон'
      OnClick = btnPrintClick
      TabOrder = 2
    end
    object btnSend: TButton
      Left = 251
      Height = 25
      Top = 10
      Width = 75
      Caption = 'Отправить'
      OnClick = btnSendClick
      TabOrder = 4
    end
    object btnScan: TButton
      Left = 89
      Height = 25
      Top = 10
      Width = 75
      Caption = 'Сканировать'
      OnClick = btnScanClick
      TabOrder = 1
    end
    object stStatus: TPanel
      Left = 251
      Height = 25
      Top = 9
      Width = 430
      Alignment = taLeftJustify
      Anchors = [akTop, akLeft, akRight]
      BevelOuter = bvLowered
      Font.Color = clWindowText
      Font.Height = -13
      Font.Name = 'Tahoma'
      Font.Style = [fsBold]
      ParentFont = False
      TabOrder = 3
    end
  end
  object pcPGS: TPageControl
    Left = 0
    Height = 339
    Top = 41
    Width = 730
    ActivePage = tsPerson
    Align = alClient
    TabIndex = 0
    TabOrder = 1
    object tsPerson: TTabSheet
      Caption = 'Посетитель'
      ClientHeight = 312
      ClientWidth = 726
      object imgPerson: TImage
        Left = 0
        Height = 312
        Top = 0
        Width = 161
        Align = alClient
        Proportional = True
        Stretch = True
      end
      object pnlPerson: TPanel
        Left = 161
        Height = 312
        Top = 0
        Width = 565
        Align = alRight
        ClientHeight = 312
        ClientWidth = 565
        TabOrder = 0
        object lblLNAME: TLabel
          Left = 51
          Height = 13
          Top = 47
          Width = 52
          Alignment = taRightJustify
          Caption = 'Фамилия'
          ParentColor = False
        end
        object lblFNAME: TLabel
          Left = 371
          Height = 13
          Top = 47
          Width = 23
          Alignment = taRightJustify
          Caption = 'Имя'
          ParentColor = False
        end
        object lblSNAME: TLabel
          Left = 46
          Height = 13
          Top = 74
          Width = 54
          Alignment = taRightJustify
          Caption = 'Отчество'
          ParentColor = False
        end
        object lblSEX: TLabel
          Left = 236
          Height = 13
          Top = 74
          Width = 22
          Alignment = taRightJustify
          Caption = 'Пол'
          ParentColor = False
        end
        object lblBDATE: TLabel
          Left = 311
          Height = 13
          Top = 74
          Width = 93
          Alignment = taRightJustify
          Caption = 'Дата рождения'
          ParentColor = False
        end
        object lblBPLACE: TLabel
          Left = 10
          Height = 13
          Top = 101
          Width = 99
          Alignment = taRightJustify
          Caption = 'Место рождения'
          ParentColor = False
        end
        object lblWhDOC: TLabel
          Left = 34
          Height = 13
          Top = 128
          Width = 71
          Alignment = taRightJustify
          Caption = 'Кем выдано'
          ParentColor = False
        end
        object lblDTDOC: TLabel
          Left = 27
          Height = 13
          Top = 155
          Width = 77
          Alignment = taRightJustify
          Caption = 'Дата выдачи'
          ParentColor = False
        end
        object lblCODEDOC: TLabel
          Left = 238
          Height = 13
          Top = 155
          Width = 119
          Alignment = taRightJustify
          Caption = 'Код подразделения'
          ParentColor = False
        end
        object lblMAIL: TLabel
          Left = 25
          Height = 13
          Top = 183
          Width = 82
          Alignment = taRightJustify
          Caption = 'Почта (e-mail)'
          ParentColor = False
        end
        object lblOLD: TLabel
          Left = 447
          Height = 13
          Top = 182
          Width = 47
          Alignment = taRightJustify
          Caption = 'Возраст'
          ParentColor = False
        end
        object lblROOM: TLabel
          Left = 260
          Height = 13
          Top = 182
          Width = 49
          Alignment = taRightJustify
          Caption = 'Кабинет'
          ParentColor = False
        end
        object lblTicket: TLabel
          Left = 360
          Height = 13
          Top = 182
          Width = 35
          Alignment = taRightJustify
          Caption = 'Талон'
          ParentColor = False
        end
        object lblDOCSER: TLabel
          Left = 64
          Height = 13
          Top = 20
          Width = 36
          Alignment = taRightJustify
          Caption = 'Серия'
          ParentColor = False
        end
        object lblDOCNUM: TLabel
          Left = 258
          Height = 13
          Top = 20
          Width = 37
          Alignment = taRightJustify
          Caption = 'Номер'
          ParentColor = False
        end
        object lblGOAL: TLabel
          Left = 31
          Height = 13
          Top = 209
          Width = 72
          Alignment = taRightJustify
          Caption = 'Цель визита'
          ParentColor = False
        end
        object lblEvaID: TLabel
          Left = 48
          Height = 13
          Top = 236
          Width = 55
          Alignment = taRightJustify
          Caption = 'ЕАВИИАС'
          ParentColor = False
        end
        object lblEvaOrg: TLabel
          Left = 59
          Height = 13
          Top = 263
          Width = 40
          Alignment = taRightJustify
          Caption = 'Состав'
          ParentColor = False
        end
        object edLNAME: TEdit
          Left = 101
          Height = 23
          Top = 44
          Width = 264
          TabOrder = 2
        end
        object edFNAME: TEdit
          Left = 396
          Height = 23
          Top = 44
          Width = 124
          TabOrder = 3
        end
        object edSNAME: TEdit
          Left = 101
          Height = 23
          Top = 71
          Width = 130
          TabOrder = 4
        end
        object edSEX: TEdit
          Left = 261
          Height = 23
          Top = 71
          Width = 40
          TabOrder = 5
        end
        object edBPLACE: TEdit
          Left = 101
          Height = 23
          Top = 98
          Width = 419
          TabOrder = 7
        end
        object edWhDOC: TEdit
          Left = 101
          Height = 23
          Top = 125
          Width = 419
          TabOrder = 8
        end
        object edCODEDOC: TEdit
          Left = 346
          Height = 23
          Top = 152
          Width = 174
          TabOrder = 10
        end
        object edMAIL: TEdit
          Left = 101
          Height = 23
          Top = 179
          Width = 153
          TabOrder = 11
        end
        object edOLD: TEdit
          Left = 493
          Height = 23
          Top = 179
          Width = 27
          ReadOnly = True
          TabOrder = 14
        end
        object edROOM: TEdit
          Left = 309
          Height = 23
          Top = 179
          Width = 45
          TabOrder = 12
        end
        object edBDATE: TDateTimePicker
          Left = 397
          Height = 19
          Top = 71
          Width = 87
          CenturyFrom = 1941
          MaxDate = 2958465
          MinDate = -53780
          TabOrder = 6
          TrailingSeparator = False
          LeadingZeros = True
          Kind = dtkDate
          TimeFormat = tf24
          TimeDisplay = tdHMS
          DateMode = dmComboBox
          Date = 43095
          Time = 0.438584305557015
          UseDefaultSeparators = True
          HideDateTimeParts = []
          MonthNames = 'Long'
          OnExit = edBDATEExit
        end
        object edDTDOC: TDateTimePicker
          Left = 101
          Height = 19
          Top = 152
          Width = 87
          CenturyFrom = 1941
          MaxDate = 2958465
          MinDate = -53780
          TabOrder = 9
          TrailingSeparator = False
          LeadingZeros = True
          Kind = dtkDate
          TimeFormat = tf24
          TimeDisplay = tdHMS
          DateMode = dmComboBox
          Date = 43095
          Time = 0.438584317133063
          UseDefaultSeparators = True
          HideDateTimeParts = []
          MonthNames = 'Long'
        end
        object edTicket: TEdit
          Left = 396
          Height = 23
          Top = 179
          Width = 45
          ReadOnly = True
          TabOrder = 13
        end
        object edDOCSER: TEdit
          Left = 101
          Height = 23
          Top = 17
          Width = 130
          TabOrder = 0
        end
        object edDOCNUM: TEdit
          Left = 295
          Height = 23
          Top = 17
          Width = 225
          TabOrder = 1
        end
        object edGOAL: TEdit
          Left = 101
          Height = 23
          Top = 206
          Width = 419
          TabOrder = 15
        end
        object edEvaID: TEdit
          Left = 101
          Height = 23
          Top = 233
          Width = 340
          ReadOnly = True
          TabOrder = 16
        end
        object btnEvaID: TButton
          Left = 447
          Height = 21
          Top = 233
          Width = 73
          Caption = 'Найти'
          OnClick = btnEvaIDClick
          TabOrder = 17
        end
        object mmOrg: TMemo
          Left = 101
          Height = 32
          Top = 260
          Width = 420
          TabOrder = 18
        end
      end
    end
    object tsTurn: TTabSheet
      Caption = 'Очередь'
      ClientHeight = 312
      ClientWidth = 726
      ImageIndex = 1
      object pnlTurn: TPanel
        Left = 0
        Height = 30
        Top = 0
        Width = 726
        Align = alTop
        BevelOuter = bvNone
        ClientHeight = 30
        ClientWidth = 726
        TabOrder = 0
        object btnTurnRefresh: TButton
          Left = 4
          Height = 25
          Top = 1
          Width = 75
          Caption = 'Обновить'
          OnClick = btnTurnRefreshClick
          TabOrder = 0
        end
      end
      object grdTurn: TDBGrid
        Left = 0
        Height = 261
        Top = 30
        Width = 726
        Align = alClient
        Color = clWindow
        Columns = <        
          item
            Title.Caption = 'NUM'
            Width = 50
            FieldName = 'NUM'
          end        
          item
            Title.Caption = 'ROOM'
            Width = 50
            FieldName = 'ROOM'
          end        
          item
            Title.Caption = 'LNAME'
            Width = 100
            FieldName = 'LNAME'
          end        
          item
            Title.Caption = 'FNAME'
            Width = 100
            FieldName = 'FNAME'
          end        
          item
            Title.Caption = 'SNAME'
            Width = 100
            FieldName = 'SNAME'
          end        
          item
            Title.Caption = 'GOAL'
            FieldName = 'GOAL'
          end>
        DataSource = ds
        TabOrder = 1
        TitleFont.Color = clWindowText
        TitleFont.Height = -11
        TitleFont.Name = 'Tahoma'
      end
      object sbTurn: TStatusBar
        Left = 0
        Height = 21
        Top = 291
        Width = 726
        Panels = <        
          item
            Width = 100
          end        
          item
            Width = 50
          end>
      end
    end
    object tsList: TTabSheet
      Caption = 'Список'
      ClientHeight = 312
      ClientWidth = 726
      ImageIndex = 2
      object pnlEva: TPanel
        Left = 0
        Height = 30
        Top = 0
        Width = 726
        Align = alTop
        BevelOuter = bvNone
        ClientHeight = 30
        ClientWidth = 726
        TabOrder = 0
        object lblEvaIP: TLabel
          Left = 125
          Height = 13
          Top = 6
          Width = 10
          Alignment = taRightJustify
          Caption = 'IP'
          ParentColor = False
        end
        object lblEvaBD: TLabel
          Left = 281
          Height = 13
          Top = 6
          Width = 17
          Alignment = taRightJustify
          Caption = 'БД'
          ParentColor = False
        end
        object lblEvaPort: TLabel
          Left = 446
          Height = 13
          Top = 8
          Width = 28
          Alignment = taRightJustify
          Caption = 'Порт'
          ParentColor = False
        end
        object btnEvaRefresh: TButton
          Left = 4
          Height = 25
          Top = 1
          Width = 75
          Caption = 'Обновить'
          OnClick = btnEvaRefreshClick
          TabOrder = 0
        end
        object edEvaIP: TEdit
          Left = 141
          Height = 23
          Top = 3
          Width = 130
          TabOrder = 1
        end
        object edEvaBD: TEdit
          Left = 301
          Height = 23
          Top = 3
          Width = 130
          TabOrder = 2
        end
        object edEvaPort: TEdit
          Left = 477
          Height = 23
          Top = 3
          Width = 44
          TabOrder = 3
        end
      end
      object grdEva: TDBGrid
        Left = 0
        Height = 261
        Top = 30
        Width = 726
        Align = alClient
        Color = clWindow
        Columns = <        
          item
            Title.Caption = 'LNAME'
            Width = 100
            FieldName = 'LNAME'
          end        
          item
            Title.Caption = 'FNAME'
            Width = 100
            FieldName = 'FNAME'
          end        
          item
            Title.Caption = 'SNAME'
            Width = 100
            FieldName = 'SNAME'
          end        
          item
            Title.Caption = 'DT_MSE'
            Width = 150
            FieldName = 'DT_MSE'
          end        
          item
            Title.Caption = 'ROOM'
            Width = 50
            FieldName = 'ROOM'
          end        
          item
            Title.Caption = 'ORG'
            Width = 200
            FieldName = 'ORG'
          end>
        DataSource = dsReg
        TabOrder = 1
        TitleFont.Color = clWindowText
        TitleFont.Height = -11
        TitleFont.Name = 'Tahoma'
        OnDblClick = grdEvaDblClick
      end
      object sbEva: TStatusBar
        Left = 0
        Height = 21
        Top = 291
        Width = 726
        Panels = <        
          item
            Width = 100
          end        
          item
            Width = 50
          end>
      end
    end
  end
  object mt: TMemDataset
    FieldDefs = <>
    AfterScroll = mtAfterScroll
    left = 304
    top = 56
    object mtNUM: TStringField
      DisplayLabel = 'Номер'
      FieldKind = fkData
      FieldName = 'NUM'
      Index = 0
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = False
      Required = False
      Size = 10
    end
    object mtROOM: TStringField
      DisplayLabel = 'Кабинет'
      FieldKind = fkData
      FieldName = 'ROOM'
      Index = 1
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = False
      Required = False
      Size = 10
    end
    object mtLNAME: TStringField
      DisplayLabel = 'Фамилия'
      FieldKind = fkData
      FieldName = 'LNAME'
      Index = 2
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = False
      Required = False
      Size = 30
    end
    object mtFNMAE: TStringField
      DisplayLabel = 'Имя'
      FieldKind = fkData
      FieldName = 'FNAME'
      Index = 3
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = False
      Required = False
      Size = 30
    end
    object mtSNAME: TStringField
      DisplayLabel = 'Отчество'
      FieldKind = fkData
      FieldName = 'SNAME'
      Index = 4
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = False
      Required = False
      Size = 30
    end
    object mtGOAL: TStringField
      DisplayLabel = 'Цель визита'
      FieldKind = fkData
      FieldName = 'GOAL'
      Index = 5
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = False
      Required = False
      Size = 50
    end
  end
  object ds: TDataSource
    DataSet = mt
    left = 344
    top = 56
  end
  object mtReg: TMemDataset
    FieldDefs = <>
    left = 304
    top = 8
    object mtRegNumReg: TIntegerField
      DisplayLabel = 'NN'
      FieldKind = fkData
      FieldName = 'NumReg'
      Index = 0
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = False
      Required = False
    end
    object mtRegNmReg: TStringField
      DisplayLabel = 'Название региона'
      FieldKind = fkData
      FieldName = 'NmReg'
      Index = 1
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = False
      Required = False
      Size = 60
    end
    object mtRegBdReg: TIntegerField
      DisplayLabel = 'БД'
      FieldKind = fkData
      FieldName = 'BdReg'
      Index = 2
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = False
      Required = False
    end
    object mtRegConnect: TStringField
      DisplayLabel = 'Подключение'
      FieldKind = fkData
      FieldName = 'Connect'
      Index = 3
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = False
      Required = False
      Size = 200
    end
  end
  object dsReg: TDataSource
    DataSet = qReg
    left = 352
    top = 8
  end
  object MSBase: TSQLConnector
    Connected = False
    LoginPrompt = False
    KeepConnection = False
    Options = []
    left = 400
    top = 8
  end
  object qReg: TSQLQuery
    FieldDefs = <>
    SQL.Strings = (
      'DECLARE @DD1 as DATE, @DD2 as DATE'
      'SET @DD1 = GETDATE()'
      ''
      'SELECT'
      '  isnull(convert(char(36),  EXR.RecipientPersonId),'''') as [GUID]'
      ', isnull(convert(nchar(30), EXR.LastName), '''') AS LNAME'
      ', isnull(convert(nchar(30), EXR.FirstName), '''') AS FNAME'
      ', isnull(convert(nchar(30), EXR.SecondName), '''') AS SNAME'
      ', isnull(EXR.AppointmentDT, '''') AS DT_MSE'
      ', isnull(convert(nchar(100), DOR.ORGANIZATION_NAME), '''') AS ORG'
      ', isnull(convert(nchar(10), DOR.Room), '''') AS ROOM'
      ''
      'FROM [dbo].[ExamRecordListView] EXR'
      ''
      'JOIN Person PSR on PSR.PersonID = EXR.RecipientPersonId'
      'JOIN DicOrganization DOR on DOR.ORGANIZATION_ID = EXR.BuroId'
      ''
      'WHERE CAST (EXR.AppointmentDT as date) = @DD1'
      ';'
    )
    Options = []
    Params = <>
    left = 448
    top = 8
    object qRegGUID: TStringField
      FieldKind = fkData
      FieldName = 'GUID'
      Index = 0
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = True
      Required = False
      Size = 36
    end
    object qRegLNAME: TWideStringField
      DisplayLabel = 'Фамилия'
      FieldKind = fkData
      FieldName = 'LNAME'
      Index = 1
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = True
      Required = False
      Size = 30
    end
    object qRegFNAME: TWideStringField
      DisplayLabel = 'Имя'
      FieldKind = fkData
      FieldName = 'FNAME'
      Index = 2
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = True
      Required = False
      Size = 30
    end
    object qRegSNAME: TWideStringField
      DisplayLabel = 'Отчество'
      FieldKind = fkData
      FieldName = 'SNAME'
      Index = 3
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = True
      Required = False
      Size = 30
    end
    object qRegDT_MSE: TDateTimeField
      DisplayLabel = 'Запись на МСЭ'
      FieldKind = fkData
      FieldName = 'DT_MSE'
      Index = 4
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = True
      Required = False
    end
    object qRegORG: TWideStringField
      DisplayLabel = 'Состав'
      FieldKind = fkData
      FieldName = 'ORG'
      Index = 5
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = True
      Required = False
      Size = 100
    end
    object qRegROOM: TWideStringField
      DisplayLabel = 'Кабинет'
      FieldKind = fkData
      FieldName = 'ROOM'
      Index = 6
      LookupCache = False
      ProviderFlags = [pfInUpdate, pfInWhere]
      ReadOnly = True
      Required = False
      Size = 10
    end
  end
end
